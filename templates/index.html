<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seedr API Tester</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        window.DEFAULT_AUTH = {
            username: "{{ default_username }}",
            password: "{{ default_password }}",
            enabled: {{ 'true' if default_auth else 'false' }}
        };
    </script>
</head>

<body{% if default_auth %} class="default-auth" {% endif %}>
    <div class="container">
        {% if default_auth %}
        <!-- Default Auth Mode Notice -->
        <div class="default-auth-notice">
            <span class="notice-icon">üîí</span>
            <div class="notice-content">
                <strong>Default Auth Mode Active</strong>
                <p>Using credentials from .env file. Authentication is automatic.</p>
            </div>
        </div>
        {% endif %}

        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="logo">
                    <span class="logo-icon">üå±</span>
                    Seedr API Tester
                </h1>
                <div class="auth-status">
                    <span id="authStatus" class="status-badge">Not Authenticated</span>
                    <button id="logoutBtn" class="btn btn-secondary" style="display: none;">Logout</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Authentication Section -->
            <section class="api-section" id="authSection">
                <h2 class="section-title">
                    <span class="section-icon">üîê</span>
                    Authentication
                </h2>

                <div class="cards-grid">
                    <!-- Device Code Flow -->
                    <div class="api-card">
                        <h3 class="card-title">Device Code Flow</h3>
                        <div class="card-content">
                            <button class="btn btn-primary" onclick="getDeviceCode()">Get Device Code</button>
                            <div id="deviceCodeInfo" class="info-box" style="display: none;"></div>
                            <div class="form-group" id="deviceCodeLoginForm" style="display: none;">
                                <input type="text" id="deviceCodeInput" placeholder="Device Code" class="input">
                                <button class="btn btn-primary" onclick="loginWithDeviceCode()">Login</button>
                            </div>
                        </div>
                    </div>

                    <!-- Password Login -->
                    <div class="api-card">
                        <h3 class="card-title">Password Login</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="email" id="username" placeholder="Email" class="input">
                                <input type="password" id="password" placeholder="Password" class="input">
                                <button class="btn btn-primary" onclick="loginWithPassword()">Login</button>
                            </div>
                        </div>
                    </div>

                    <!-- Refresh Token Login -->
                    <div class="api-card">
                        <h3 class="card-title">Refresh Token Login</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="refreshToken" placeholder="Refresh Token" class="input">
                                <button class="btn btn-primary" onclick="loginWithRefreshToken()">Login</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Account Management Section -->
            <section class="api-section" id="accountSection">
                <h2 class="section-title">
                    <span class="section-icon">üë§</span>
                    Account Management
                </h2>

                <div class="cards-grid">
                    <!-- Get Settings -->
                    <div class="api-card">
                        <h3 class="card-title">Account Settings</h3>
                        <div class="card-content">
                            <button class="btn btn-primary" onclick="getSettings()">Get Settings</button>
                        </div>
                    </div>

                    <!-- Get Memory & Bandwidth -->
                    <div class="api-card">
                        <h3 class="card-title">Memory & Bandwidth</h3>
                        <div class="card-content">
                            <button class="btn btn-primary" onclick="getMemoryBandwidth()">Get Usage</button>
                        </div>
                    </div>

                    <!-- Get Devices -->
                    <div class="api-card">
                        <h3 class="card-title">Authorized Devices</h3>
                        <div class="card-content">
                            <button class="btn btn-primary" onclick="getDevices()">Get Devices</button>
                        </div>
                    </div>

                    <!-- Change Name -->
                    <div class="api-card">
                        <h3 class="card-title">Change Name</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="newName" placeholder="New Name" class="input">
                                <input type="password" id="changeNamePassword" placeholder="Current Password"
                                    class="input">
                                <button class="btn btn-primary" onclick="changeName()">Update Name</button>
                            </div>
                        </div>
                    </div>

                    <!-- Change Password -->
                    <div class="api-card">
                        <h3 class="card-title">Change Password</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="password" id="oldPassword" placeholder="Old Password" class="input">
                                <input type="password" id="newPassword" placeholder="New Password" class="input">
                                <button class="btn btn-primary" onclick="changePassword()">Update Password</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Files & Folders Section -->
            <section class="api-section" id="filesSection">
                <h2 class="section-title">
                    <span class="section-icon">üìÅ</span>
                    Files & Folders
                </h2>

                <div class="cards-grid">
                    <!-- List Files -->
                    <div class="api-card">
                        <h3 class="card-title">List Files</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="listFolderId" placeholder="Folder ID (default: 0)" class="input">
                                <button class="btn btn-primary" onclick="listFiles()">List Files</button>
                            </div>
                        </div>
                    </div>

                    <!-- List All Files (Recursive) -->
                    <div class="api-card">
                        <h3 class="card-title">List All Files (Recursive)</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <button class="btn btn-primary" onclick="listAllFiles()">List All Files</button>
                            </div>
                        </div>
                    </div>

                    <!-- Create Folder -->
                    <div class="api-card">
                        <h3 class="card-title">Create Folder</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="folderName" placeholder="Folder Name" class="input">
                                <input type="text" id="parentFolderId" placeholder="Parent Folder ID (default: 0)"
                                    class="input">
                                <button class="btn btn-primary" onclick="createFolder()">Create</button>
                            </div>
                        </div>
                    </div>

                    <!-- Rename File -->
                    <div class="api-card">
                        <h3 class="card-title">Rename File</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="renameFileId" placeholder="File ID" class="input">
                                <input type="text" id="newFileName" placeholder="New Name" class="input">
                                <button class="btn btn-primary" onclick="renameFile()">Rename</button>
                            </div>
                        </div>
                    </div>

                    <!-- Rename Folder -->
                    <div class="api-card">
                        <h3 class="card-title">Rename Folder</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="renameFolderId" placeholder="Folder ID" class="input">
                                <input type="text" id="newFolderName" placeholder="New Name" class="input">
                                <button class="btn btn-primary" onclick="renameFolder()">Rename</button>
                            </div>
                        </div>
                    </div>

                    <!-- Delete File -->
                    <div class="api-card">
                        <h3 class="card-title">Delete File</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="deleteFileId" placeholder="File ID" class="input">
                                <button class="btn btn-danger" onclick="deleteFile()">Delete</button>
                            </div>
                        </div>
                    </div>

                    <!-- Delete Folder -->
                    <div class="api-card">
                        <h3 class="card-title">Delete Folder</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="deleteFolderId" placeholder="Folder ID" class="input">
                                <button class="btn btn-danger" onclick="deleteFolder()">Delete</button>
                            </div>
                        </div>
                    </div>

                    <!-- Search Files -->
                    <div class="api-card">
                        <h3 class="card-title">Search Files</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="searchQuery" placeholder="Search Query" class="input">
                                <button class="btn btn-primary" onclick="searchFiles()">Search</button>
                            </div>
                        </div>
                    </div>

                    <!-- Get Download URL -->
                    <div class="api-card">
                        <h3 class="card-title">Get Download URL</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="fetchFileId" placeholder="File ID" class="input">
                                <button class="btn btn-primary" onclick="fetchFile()">Get URL</button>
                            </div>
                        </div>
                    </div>

                    <!-- Download All Files in Folder -->
                    <div class="api-card">
                        <h3 class="card-title">üì• Download All Files in Folder</h3>
                        <div class="card-content">
                            <p class="card-description"
                                style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1rem;">
                                Enter a Folder ID to get individual download links for all files in that folder.
                            </p>
                            <div class="form-group">
                                <input type="text" id="downloadFolderId" placeholder="Folder ID" class="input">
                                <button class="btn btn-primary" onclick="downloadFolder()">Get All Download
                                    Links</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Torrents Section -->
            <section class="api-section" id="torrentsSection">
                <h2 class="section-title">
                    <span class="section-icon">üß≤</span>
                    Torrents
                </h2>

                <div class="cards-grid">
                    <!-- List Active Torrents -->
                    <div class="api-card">
                        <h3 class="card-title">üìä List Active Torrents</h3>
                        <div class="card-content">
                            <p class="card-description"
                                style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1rem;">
                                View all downloading torrents with their progress. Delete slow ones if needed.
                            </p>
                            <div class="form-group">
                                <button class="btn btn-primary" onclick="listTorrents()">Show Active Torrents</button>
                            </div>
                        </div>
                    </div>



                    <!-- Add Torrent (Magnet) -->
                    <div class="api-card">
                        <h3 class="card-title">Add Torrent (Magnet)</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="magnetLink" placeholder="Magnet Link" class="input">
                                <input type="text" id="magnetFolderId" placeholder="Folder ID (default: -1)"
                                    class="input">
                                <button class="btn btn-primary" onclick="addTorrentMagnet()">Add Torrent</button>
                            </div>
                        </div>
                    </div>

                    <!-- Add Torrent (File) -->
                    <div class="api-card">
                        <h3 class="card-title">Add Torrent (File)</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="file" id="torrentFile" accept=".torrent" class="input-file">
                                <input type="text" id="fileFolderId" placeholder="Folder ID (default: -1)"
                                    class="input">
                                <button class="btn btn-primary" onclick="addTorrentFile()">Upload Torrent</button>
                            </div>
                        </div>
                    </div>

                    <!-- Delete Torrent -->
                    <div class="api-card">
                        <h3 class="card-title">Delete Torrent</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="deleteTorrentId" placeholder="Torrent ID" class="input">
                                <button class="btn btn-danger" onclick="deleteTorrent()">Delete</button>
                            </div>
                        </div>
                    </div>

                    <!-- Scan Page -->
                    <div class="api-card">
                        <h3 class="card-title">Scan Page for Torrents</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="url" id="scanUrl" placeholder="URL to Scan" class="input">
                                <button class="btn btn-primary" onclick="scanPage()">Scan</button>
                            </div>
                        </div>
                    </div>

                    <!-- Delete Wishlist -->
                    <div class="api-card">
                        <h3 class="card-title">Delete Wishlist Item</h3>
                        <div class="card-content">
                            <div class="form-group">
                                <input type="text" id="wishlistId" placeholder="Wishlist ID" class="input">
                                <button class="btn btn-danger" onclick="deleteWishlist()">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Response Viewer -->
            <section class="response-section">
                <h2 class="section-title">
                    <span class="section-icon">üìä</span>
                    API Response
                </h2>
                <div class="response-container">
                    <div class="response-header">
                        <span id="responseStatus" class="response-status"></span>
                        <button class="btn btn-secondary btn-sm" onclick="clearResponse()">Clear</button>
                    </div>
                    <pre id="responseOutput" class="response-output">No response yet. Try an API call!</pre>
                </div>
            </section>
        </main>
    </div>

    <script src="/static/app.js"></script>
    </body>

</html>